{% extends '@UnitedCMSCore/layout.html.twig' %}
{% block title %}{{ domain }}: User{% endblock title %}
{% block navtitle %}{{ include('@UnitedCMSCore/Domain/_navtitle.html.twig') }}{% endblock %}
{% block navigation %}{{ include('@UnitedCMSCore/Domain/_navigation.domain.html.twig') }}{% endblock navigation %}
{% block content %}

    <h1 class="uk-heading-divider">
        Domain Users <a href="{{ path('unitedcms_core_domainuser_create', {
            domain: domain.identifier,
            organization: organization.identifier
        }) }}" class="uk-icon-button uk-button-primary" uk-icon="icon: plus"></a>
    </h1>

    <div class="uk-card uk-card-default uk-card-body">
        <table class="uk-table uk-table-justify uk-table-divider">
            <thead>
            <tr>
                <th>{{ knp_pagination_sortable(users, 'Firstname', 'user.firstname') }}</th>
                <th>{{ knp_pagination_sortable(users, 'Lastname', 'user.lastname') }}</th>
                <th>{{ knp_pagination_sortable(users, 'Email', 'user.email') }}</th>
                <th>{{ knp_pagination_sortable(users, 'Roles', 'user.roles') }}</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for member in users %}
                <tr>
                    <td>{{ member.user.firstname }}</td>
                    <td>{{ member.user.lastname }}</td>
                    <td>{{ member.user.email }}</td>
                    <td>{{ member.roles|join(', ') }}</td>
                    <td>
                        <ul class="uk-iconnav">
                            <li><a href="{{ path('unitedcms_core_domainuser_update', {
                                    domain: domain.identifier,
                                    organization: organization.identifier,
                                    member: member.id
                                }) }}" uk-icon="icon: file-edit"></a></li>
                            <li><a class="uk-text-danger" href="{{ path('unitedcms_core_domainuser_delete', {
                                    domain: domain.identifier,
                                    organization: organization.identifier,
                                    member: member.id
                                }) }}" uk-icon="icon: trash"></a></li>
                        </ul>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <div class="navigation">
            {{ knp_pagination_render(users) }}
        </div>
    </div>

    {% if invites|length > 0 %}
        <h1 class="uk-heading-divider">Pending Invitations</h1>

        <div class="uk-card uk-card-default uk-card-body">
            <table class="uk-table uk-table-justify uk-table-divider">
                <thead>
                <tr>
                    <th>{{ knp_pagination_sortable(invites, 'Email', 'email') }}</th>
                    <th>{{ knp_pagination_sortable(invites, 'Roles', 'roles') }}</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                {% for invite in invites %}
                    <tr>
                        <td>{{ invite.email }}</td>
                        <td>{{ invite.roles|join(', ') }}</td>
                        <td>
                            <ul class="uk-iconnav">
                                <li><a class="uk-text-danger" href="{{ path('unitedcms_core_domainuser_deleteinvite', {
                                        organization: organization.identifier,
                                        domain: domain.identifier,
                                        invite: invite.id
                                    }) }}" uk-icon="icon: trash"></a></li>
                            </ul>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="navigation">
                {{ knp_pagination_render(users) }}
            </div>
        </div>
    {% endif %}

{% endblock content %}